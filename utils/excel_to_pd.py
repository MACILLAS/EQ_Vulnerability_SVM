import pandas as pd


def main_haiti(filename):
    df = pd.read_csv(filename)
    df = df.drop(labels=["Photographer", "Unnamed: 36", "Date", "Latitude D", "Latitude M", "Latitude S", "Longitude D",
                         "Longitude M", "Longitude S", "Priority Index 2", "CW Damage", "PermenantDrift",
                         "DiagramPreview",
                         "PictureCollection"], axis=1)
    df = df.drop([0, 1])
    df.reset_index()
    df = df[df['Priority Index 1'].notna()]  # Unable to collect data (theaters, gyms etc)
    df = df[df['Priority Index 1'] != 0]  # Missing information
    df = df[df['RC Damage'].notna()]  # Block houses
    df = df.replace("Concreat", "Concrete")  # Misspelling
    df.to_csv("haiti.csv", header=True, index=False)


if __name__ == "__main__":
    filename = "/media/cviss/Disk 2/data/EQ/EQ_Vulnerability_SVM/data/Haiti/NEES_Database__The_Haiti_Earthquake_Database.csv"
    main_haiti(filename)
